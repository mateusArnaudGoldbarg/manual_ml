/*
Title: model.hpp
Description: model header file of the project: Iris predictions using pre trained Artificial Neural Network model
Author: Mateus Arnaud Goldbarg
Date: 07/16/2022
*/
#ifndef MODEL_HPP
#define MODEL_HPP
#include <string>
#include <memory>
/*
model achtecture:
Input(4)
Dense(10)
Relu
Dense(10)
Relu
Dense(3) OUTPUT
Softmax
*/

class Model{
	private:
		float dense1[4][10];
		float bias1[10];
		float dense2[10][10];
		float bias2[10];
		float dense3[10][3];
		float bias3[3];
		
	public:
		Model() : 
		dense1
		{{0.6687432 , -0.61946446,  0.3925613 , -0.6256361 , -0.15233004, -0.25770617, -0.22145933, -0.03116034, -0.07213708,  0.08552536},
    		{-0.15384062, -0.01874369,  0.23976368, -0.4667834 ,  0.19747084, 0.26759177, -0.10567456,  0.65256625,  0.51775897,  0.5700992},
    		{-0.42176914, -0.21216655,  0.47330087, -0.38930824, -0.5198719 , -0.38937613, -0.37584838, -0.37032893,  0.26524904, -0.13616402},
    		{-0.7625424 ,  0.5622983 , -0.00712274,  0.41868675,  0.29586202, -0.36771357, -0.37170506,  0.14083412,  0.38264477, -0.8290541}},
    		
    		bias1 
    		{0.24006544, 0., 0.16063713, 0., 0., 0., 0., 0.2148306 , -0.0584112 , 0.2479922},
    		
    		dense2
    		{{-0.29739213, -0.22500926, -0.10855037,  0.7298434 , -0.53956246, -0.5398267 , -0.01083072, -0.26863214,  0.01156667, -0.18011901},
    		{0.31247383, -0.2321465 ,  0.39591742,  0.20740545, -0.05782652, 0.25544977,  0.24316663,  0.31299895,  0.35384   ,  0.1810934},
    		{0.24080151,  0.17036909, -0.53536105,  0.15171672, -0.42196497, 0.32947737,  0.5429214 ,  0.05955783,  0.17480844,  0.18949954},
    		{0.11729097,  0.31882328, -0.3543349 , -0.5272235 , -0.04200405, -0.51716244, -0.35328197, -0.16308609,  0.11375809, -0.33453983},
    		{-0.25483695,  0.47168303,  0.1541977 ,  0.13094258, -0.08729535, -0.07018867,  0.07240307, -0.09452295, -0.21073556,  0.11810219},
    		{0.34700984, -0.47711313, -0.25615066,  0.4067564 , -0.5387563 , 0.13295674,  0.29907662,  0.44826865, -0.20021334, -0.46627754},
    		{-0.03119129, -0.25777385,  0.23519677, -0.35060978,  0.10879928, 0.52065694,  0.30564505, -0.39896673, -0.46277663, -0.11475655},
    		{-0.63703847,  0.29780436, -0.0149141 ,  0.29069972,  0.10697639, -0.80365217, -0.0464714 ,  0.09054808,  0.63129264,  0.05229133},
    		{0.4513428 , -0.48679972, -0.24581546,  0.02314935, -0.33189362, 0.2237683 , -0.16999945,  0.43483242, -0.38344556, -0.41985488},
    		{-0.06954266, -0.43285164, -0.46618026, -0.01503766, -0.5291566 , -0.6901622 , -0.26706317,  0.64305425,  0.7389528 , -0.51186097}},
    		
    		bias2
    		{0.22483708, 0.,  0., 0.05908684, 0., -0.13067733, 0.09735662, -0.08622272, 0.18277514, -0.01721832},
    		
    		dense3
    		{{-1.05251837e+00,  2.67649651e-01,  6.58927143e-01},
    		{-2.92397201e-01, -3.27374756e-01, -6.42964125e-01},
    		{-7.23392963e-02,  4.92245674e-01, -5.95382810e-01},
    		{8.12956512e-01,  1.22013241e-01,  1.60962027e-02},
    		{2.07023084e-01,  3.44308615e-02,  6.62096977e-01},
    		{-4.95905906e-01, -5.09886980e-01,  5.76161146e-01},
    		{-5.66885412e-01,  6.03131890e-01, -6.05843186e-01},
    		{2.81837851e-01, -5.21260142e-01,  2.97065705e-01},
    		{5.47878027e-01,  1.97345495e-01, -7.20538557e-01},
    		{-4.90674287e-01,  1.04821526e-01,  2.49630335e-04}},
    		
    		bias3
    		{0.08492658, 0.08103085, -0.2379903}
    
    		{}; 
		
		void getWeights();
		
		std::string predict(float input[], int verbose);
		
		
};

#endif
